
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta property="og:title" content="Status Bot | Settings" />
    <meta property="og:description" content="View and customize your settings for Status Bot website!" />
    <meta property="og:url" content="https://status-bot.xyz/settings" />
    <meta name="theme-color" content="#4162ff" />
    <title>Status Bot | Settings</title>
    <link rel="icon" type="image/png" href="https://i.postimg.cc/fRHzdcrb/Copy-of-S.png" />
    <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Poppins:wght@400;500;600;700&display=swap"
        rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" />
    <style>
        :root {
            --bg-1: rgba(65, 98, 255, 0.06);
            --bg-2: rgba(65, 98, 255, 0.18);
            --page-bg: #141414;
            --panel: rgba(25, 25, 25, 0.65);
            --accent: #4162ff;
            --text: #fff;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif
        }

        body {
            color: var(--text);
            min-height: 100vh;
            background: var(--page-bg);
            background-image:
                radial-gradient(circle at 94% 6%, rgba(65, 98, 255, 0.48), var(--bg-1) 340px, transparent 500px),
                radial-gradient(circle at 0% 88%, rgba(65, 98, 255, 0.48), var(--bg-1) 340px, transparent 500px),
                radial-gradient(circle at 75% 105%, rgba(65, 98, 255, 0.45), rgba(65, 98, 255, 0.05) 300px, transparent 500px),
                radial-gradient(circle at 20% 20%, rgba(65, 98, 255, 0.22), transparent 320px),
                radial-gradient(circle at 80% 70%, rgba(65, 98, 255, 0.18), transparent 300px),
                radial-gradient(circle at 50% 10%, rgba(65, 98, 255, 0.15), transparent 260px),
                radial-gradient(circle at 12% 60%, rgba(65, 98, 255, 0.22), transparent 300px);
            background-attachment: fixed;
            background-size: cover;
            transition: background 420ms ease, background-image 420ms ease;
        }

        .settings-container {
            display: flex;
            min-height: 100vh
        }

        .sidebar {
            width: 260px;
            padding: 28px 18px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            background: rgba(0, 0, 0, 0.32);
            backdrop-filter: blur(8px);
            border-right: 1px solid rgba(255, 255, 255, 0.04);
        }

        .sidebar-buttons {
            margin-top: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .profile-box {
            display: flex;
            align-items: center;
            gap: 12px;
            background: #1a1a1a;
            padding: 10px 14px;
            border-radius: 999px
        }

        .profile-box img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover
        }

        .profile-name {
            font-size: 16px;
            font-weight: 700
        }

        .divider {
            height: 2px;
            width: 100%;
            background: #fff;
            opacity: .15;
            margin: 6px 0
        }

        .menu-section {
            display: flex;
            flex-direction: column;
            gap: 18px;
            margin-top: 6px
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 18px;
            opacity: .92;
            padding: 10px 12px;
            border-radius: 10px;
            cursor: pointer
        }

        .menu-item.active {
            background: rgba(255, 255, 255, 0.03);
            font-weight: 700
        }

        .menu-item i {
            width: 22px;
            text-align: center;
            opacity: .85
        }

        .logout-btn {
            margin-top: auto;
            background: #b71c1c;
            color: white;
            padding: 12px;
            border-radius: 12px;
            text-align: center;
            font-weight: 700;
            cursor: pointer
        }

        .logout-btn i {
            margin-right: 8px
        }

        .page-content {
            flex: 1;
            padding: 48px 64px 160px 64px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 28px
        }

        .page-title {
            font-size: 36px;
            font-weight: 800
        }

        .page-desc {
            opacity: .82;
            max-width: 760px;
            text-align: center
        }

        .appearance-panel {
            width: 100%;
            max-width: 1060px;
            background: rgba(0, 0, 0, 0.45);
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 6px 30px rgba(0, 0, 0, 0.6)
        }

        .swatches-row {
            display: flex;
            justify-content: center;
            gap: 42px;
            flex-wrap: wrap;
            padding: 26px 12px
        }

        .swatch {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.45);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            cursor: pointer;
            transition: transform .18s, box-shadow .18s;
            position: relative;
        }

        .swatch:hover {
            transform: translateY(-6px)
        }

        .swatch-label {
            margin-top: 12px;
            font-size: 14px;
            opacity: .95;
            text-align: center
        }

        .swatch.small {
            width: 64px;
            height: 64px
        }

        .swatch-grid {
            display: flex;
            justify-content: center;
            gap: 24px;
            margin-top: 18px
        }

        .swatch.selected::after {
            content: "";
            position: absolute;
            inset: auto -6px -6px -6px;
            border-radius: inherit;
            box-shadow: 0 0 0 4px rgba(65, 98, 255, 0.08), 0 10px 26px rgba(65, 98, 255, 0.06);
            transform: translateY(2px);
        }

        .s-sunset {
            background: linear-gradient(180deg, #ffb86b, #7e4bb8)
        }

        .s-obsidian {
            background: linear-gradient(180deg, #0b0b0b, #4d4d4d)
        }

        .s-saphire {
            background: linear-gradient(180deg, #00b0ff, #0b3cff)
        }

        .s-parrot {
            background: linear-gradient(180deg, #69f0ae, #00bcd4)
        }

        .s-icicle {
            background: linear-gradient(180deg, #e0f7fa, #8ec5ff)
        }

        .s-lime {
            background: linear-gradient(180deg, #b0ff6d, #7be35a)
        }

        .s-light {
            background: #ffffff
        }

        .s-default {
            background: linear-gradient(180deg, #ffffff, #2630b6);
            filter: contrast(.95)
        }

        .s-dark {
            background: linear-gradient(180deg, #0b0b0b, #2b2b2b)
        }

        .site-footer {
            background: #1f1f1f;
            color: #fff;
            padding: 36px 28px 56px;
            font-size: 16px;
            line-height: 1.4;
            margin-top: -1px
        }

        .footer-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto 14px
        }

        .footer-logo {
            font-family: 'Archivo Black';
            font-size: 32px;
            background: linear-gradient(90deg, #4162ff, #9ca3af);
            -webkit-background-clip: text;
            color: transparent
        }

        .footer-bottom {
            text-align: center;
            opacity: .9;
            margin-top: 8px
        }

        .billing-panel {
            width: 100%;
            max-width: 860px;
            background: var(--panel);
            padding: 36px;
            min-height: 480px;
            border-radius: 12px;
            box-shadow: 0 6px 30px rgba(0, 0, 0, 0.5);
        }

        .billing-list {
            display: flex;
            flex-direction: column;
            gap: 18px;
            margin-top: 24px;
        }

        .billing-entry {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.03);
            padding: 14px 18px;
            border-radius: 10px;
            font-size: 18px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .billing-entry:hover {
            background: rgba(255, 255, 255, 0.06);
        }

        .billing-empty {
            text-align: center;
            font-size: 16px;
            opacity: 0.7;
            margin-top: 32px;
        }

        .billing-pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 18px;
            margin-top: 32px;
        }

        .page-arrow {
            background: rgba(255, 255, 255, 0.08);
            border: none;
            color: white;
            padding: 8px 14px;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
        }

        .page-number {
            font-weight: 600;
            font-size: 16px;
        }

        .gifts-panel {
            width: 100%;
            max-width: 1060px;
            background: rgba(0, 0, 0, 0.45);
            padding: 36px;
            border-radius: 12px;
            box-shadow: 0 6px 30px rgba(0, 0, 0, 0.45);
        }

        .gifts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 28px;
            justify-items: center;
            align-items: center;
            padding: 8px 12px;
        }

        .gift-item {
            width: 140px;
            height: 140px;
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.02), rgba(255, 255, 255, 0.01));
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform .18s, box-shadow .18s;
            position: relative;
        }

        .gift-item:hover {
            transform: translateY(-6px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.6);
        }

        .gift-icon {
            width: 96px;
            height: 96px;
            background: #ffd3da;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 46px;
            color: #a11a3a;
        }

        .gift-title {
            margin-top: 8px;
            font-size: 14px;
            text-align: center;
            color: rgba(255, 255, 255, 0.92)
        }

        /* Modal */
        .gift-modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 60;
        }

        .gift-modal {
            width: min(720px, 92%);
            background: #0f0f10;
            padding: 22px;
            border-radius: 12px;
            box-shadow: 0 12px 60px rgba(0, 0, 0, 0.7);
            color: #fff;
            position: relative;
        }

        .gift-modal .preview {
            background: rgba(255, 255, 255, 0.03);
            padding: 16px;
            border-radius: 8px;
            min-height: 120px;
            margin: 8px 0 14px 0
        }

        .gift-modal .gift-modal-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end
        }

        .btn-claim {
            background: linear-gradient(90deg, #ff7a9a, #ff4b6e);
            color: #fff;
            border: none;
            padding: 10px 16px;
            border-radius: 8px;
            cursor: pointer
        }

        .btn-close {
            background: rgba(255, 255, 255, 0.06);
            color: #fff;
            border: none;
            padding: 10px 12px;
            border-radius: 8px;
            cursor: pointer
        }

        @media (max-width:900px) {
            .sidebar {
                display: none
            }

            .page-content {
                padding: 28px
            }
        }
    </style>
</head>

<body>

    <div class="settings-container">

        <aside class="sidebar" aria-label="Settings sidebar">
            <div class="profile-box" id="profileBox">
                <img id="profileAvatar" src="/mnt/data/Username (1).png" alt="avatar" />
                <div>
                    <div class="profile-name" id="profileName">Username</div>
                </div>
            </div>

            <div class="divider" aria-hidden="true"></div>

            <nav class="menu-section" role="tablist" aria-orientation="vertical">
                <div class="menu-item active" data-tab="appearance" role="tab"><i class="fas fa-moon"></i> Appearance
                </div>
                <div class="menu-item" data-tab="billing" role="tab"><i class="fas fa-dollar-sign"></i> Billing</div>
                <div class="menu-item" data-tab="gifts" role="tab"><i class="fas fa-gift"></i> Gifts</div>
            </nav>

            <div class="sidebar-buttons">
                <div class="logout-btn" id="homeBtn" role="button" style="background:#4162ff;">
                    <i class="fas fa-house"></i> Home
                </div>

                <div class="logout-btn" id="logoutBtn" role="button">
                    <i class="fas fa-arrow-right-from-bracket"></i> Log Out
                </div>
            </div>
        </aside>

        <main class="page-content" id="mainContent">

            <h1 class="page-title" id="pageTitle">Change your page appearance!</h1>
            <p class="page-desc" id="pageDesc">Choose from our preset color schemes to make our website look the way
                <strong>you</strong> want!
            </p>

            <section class="appearance-panel" id="appearancePanel" role="region" aria-labelledby="appearanceTitle">
                <div class="swatches-row" id="swatchesRow">
                    <div class="swatch s-sunset" data-theme="sunset" title="Sun Set"></div>
                    <div class="swatch s-obsidian" data-theme="obsidian" title="Obsidian"></div>
                    <div class="swatch s-saphire" data-theme="saphire" title="Saphire"></div>
                    <div class="swatch s-parrot" data-theme="parrot" title="Parrot"></div>
                    <div class="swatch s-icicle" data-theme="icicle" title="Icicle"></div>
                    <div class="swatch s-lime" data-theme="lime" title="Lime"></div>
                </div>

                <div class="swatch-grid" id="swatchGrid">
                    <div class="swatch small s-light" data-theme="light" title="Light"></div>
                    <div class="swatch small s-default" data-theme="default" title="Default"></div>
                    <div class="swatch small s-dark" data-theme="dark" title="Dark"></div>
                </div>

                <div style="text-align:center;margin-top:18px;color:rgba(255,255,255,.65);font-size:14px">
                    Your selection will be saved locally and loaded automatically on your next visit.
                </div>
            </section>

            <section class="billing-panel" id="billingPanel" role="region" aria-labelledby="billingTitle">
                <h1 class="page-title">Transactions</h1>
                <div class="billing-list" id="billingList">
                </div>
                <div class="billing-pagination">
                    <button class="page-arrow" id="prevPage">&lt;</button>
                    <span class="page-number">Page 1</span>
                    <button class="page-arrow" id="nextPage">&gt;</button>
                </div>
            </section>

            <section class="gifts-panel" id="giftsPanel" role="region" aria-labelledby="giftsTitle">
                <h1 class="page-title">Claim Gifts Here</h1>
                <div class="gifts-grid" id="giftsGrid">
                </div>
            </section>

        </main>
    </div>

    <footer class="site-footer" role="contentinfo">
        <div class="footer-top">
            <div class="footer-left"><span class="footer-logo">Status Bot</span></div>
            <div class="footer-right">
                <a href="/terms" style="color:#fff;text-decoration:none">Terms</a> |
                <a href="/privacy" style="color:#fff;text-decoration:none">Privacy</a> |
                <a href="https://discord.gg/Kd2MckVxED" style="color:#fff;text-decoration:none">Support</a>
            </div>
        </div>
        <div class="footer-bottom">Â© 2025 Status Bot. All rights reserved.</div>
    </footer>

    <div id="giftModal" class="gift-modal-overlay" style="display:none;">
        <div class="gift-modal" role="dialog" aria-modal="true">
            <button id="closeGiftX" class="btn-close"
                style="position:absolute;right:12px;top:12px;font-size:18px">âœ•</button>
            <h2 id="giftModalTitle">Gift</h2>
            <div id="giftModalPreview" class="preview">Preview area</div>
            <p id="giftModalDesc"></p>
            <div class="gift-modal-actions">
                <button id="claimGiftBtn" class="btn-claim">Claim Gift</button>
                <button id="closeGiftBtn" class="btn-close">Close</button>
            </div>
        </div>
    </div>

    <script>
        const DISCORD_API = "https://discord.com/api/users/@me";
        const DISCORD_CLIENT_ID = "1436123870158520411";
        const REDIRECT_URI = window.location.origin + "/settings";
        const OAUTH_URL = `https://discord.com/oauth2/authorize?client_id=${DISCORD_CLIENT_ID}&response_type=token&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&scope=identify`;

        const profileNameEl = document.getElementById("profileName");
        const profileAvatarEl = document.getElementById("profileAvatar");
        const logoutBtn = document.getElementById("logoutBtn");
        const homeBtn = document.getElementById("homeBtn");

        function getAccessTokenFromHash() {
            const hash = window.location.hash;
            if (!hash) return null;
            const params = new URLSearchParams(hash.substring(1));
            return params.get("access_token");
        }

        function getToken() {
            const tokenFromHash = getAccessTokenFromHash();
            if (tokenFromHash) {
                localStorage.setItem("discord_token", tokenFromHash);
                window.history.replaceState({}, document.title, window.location.pathname + window.location.search);
                return tokenFromHash;
            }
            return localStorage.getItem("discord_token");
        }

        async function fetchDiscordUser(token) {
            const res = await fetch(DISCORD_API, { headers: { Authorization: `Bearer ${token}` } });
            if (!res.ok) throw new Error("Failed to fetch user");
            return res.json();
        }


        async function fetchGifts(userId) {
            const res = await fetch(`https://status-bot-backend.onrender.com/api/gifts?userId=${userId}`);
            if (!res.ok) return [];
            return await res.json();
        }

        async function renderGifts(userId) {
            const grid = document.getElementById('giftsGrid');
            if (!grid) return;
            const gifts = await fetchGifts(userId);
            grid.innerHTML = '';
            if (!gifts || gifts.length === 0) {
                const empty = document.createElement('div');
                empty.className = 'billing-empty';
                empty.textContent = 'No pending gifts';
                grid.appendChild(empty);
                return;
            }
            gifts.forEach(g => {
                const item = document.createElement('div');
                item.className = 'gift-item';
                item.dataset.giftId = g.id;
                const icon = document.createElement('div');
                icon.className = 'gift-icon';
                icon.textContent = 'ðŸŽ';
                item.appendChild(icon);
                const label = document.createElement('div');
                label.className = 'gift-title';
                label.textContent = g.title;
                item.appendChild(label);
                item.addEventListener('click', () => openGiftModal(g.id, userId));
                grid.appendChild(item);
            });
        }

        async function openGiftModal(giftId, userId) {
            const gifts = await fetchGifts(userId);
            const g = gifts.find(x => x.id === giftId);
            if (!g) return;
            document.getElementById('giftModalTitle').textContent = g.title;
            document.getElementById('giftModalDesc').textContent = g.desc;
            const preview = document.getElementById('giftModalPreview');
            preview.innerHTML = '';
            const p = document.createElement('div');
            p.textContent = 'Click claim to generate your premium key.';
            preview.appendChild(p);

            const overlay = document.getElementById('giftModal');
            overlay.style.display = 'flex';

            const claimBtn = document.getElementById('claimGiftBtn');
            claimBtn.onclick = async () => {
                const res = await fetch('https://status-bot-backend.onrender.com/api/gifts/claim', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ userId, giftId })
                });
                if (res.ok) {
                    const data = await res.json();
                    preview.innerHTML = `<b>Your Premium Key:</b><br><code>${data.key}</code><br>Expires: ${data.expires_at ? data.expires_at : 'Never'}`;
                    setTimeout(() => { overlay.style.display = 'none'; renderGifts(userId); }, 4000);
                } else {
                    preview.innerHTML = 'Error claiming gift.';
                }
            };
        }

        function addDeveloperTrialButton(userId) {
            if (document.getElementById('devTrialBtn')) return;
            const btn = document.createElement('button');
            btn.id = 'devTrialBtn';
            btn.textContent = 'Send Free Trial Gift';
            btn.style = 'margin: 18px 0; background: #4162ff; color: #fff; font-weight: 700; border: none; border-radius: 10px; padding: 12px 24px; cursor: pointer; font-size: 18px;';

            const select = document.createElement('select');
            select.id = 'devTrialDuration';
            select.style = 'margin-left: 12px; font-size: 16px; padding: 6px; border-radius: 6px;';
            [
                {label: '1 Day', value: '1 day'},
                {label: '3 Days', value: '3 days'},
                {label: '7 Days', value: '7 days'},
                {label: '1 Month', value: '1 month'}
            ].forEach(opt => {
                const o = document.createElement('option');
                o.value = opt.value;
                o.textContent = opt.label;
                select.appendChild(o);
            });
            btn.appendChild(select);

            btn.addEventListener('click', async function(e) {
                e.preventDefault();
                const duration = select.value;
                const res = await fetch('https://status-bot-backend.onrender.com/api/gifts/send', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ userId, duration })
                });
                if (res.ok) {
                    alert('Trial gift sent to all users!');
                    renderGifts(userId);
                } else {
                    alert('Error sending trial gift.');
                }
            });

            const giftsPanel = document.getElementById('giftsPanel');
            giftsPanel.parentNode.insertBefore(btn, giftsPanel);
        }

        async function initProfile() {
            const token = getToken();
            if (!token) {
                profileAvatarEl.onclick = () => window.location.href = OAUTH_URL;
                profileNameEl.parentElement.style.cursor = "pointer";
                profileNameEl.parentElement.onclick = () => window.location.href = OAUTH_URL;
                return;
            }

            try {
                const user = await fetchDiscordUser(token);
                const avatar = user.avatar ? `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png` : "/mnt/data/Username (1).png";
                profileAvatarEl.src = avatar;
                profileNameEl.textContent = user.username;
                profileAvatarEl.onclick = null;
                profileNameEl.parentElement.onclick = null;
                if (user.id === "1362553254117904496") {
                    addDeveloperTrialButton(user.id);
                }
                renderGifts(user.id);
            } catch (err) {
                localStorage.removeItem("discord_token");
                profileAvatarEl.onclick = () => window.location.href = OAUTH_URL;
                profileNameEl.parentElement.onclick = () => window.location.href = OAUTH_URL;
            }
        }

        logoutBtn.addEventListener("click", () => {
            localStorage.removeItem("discord_token");
            window.location.href = "/";
        });

        homeBtn.addEventListener("click", () => {
            window.location.href = "/";
        });


        const THEME_KEY = "site_theme";

        const themes = {
            "sunset": () => {
                document.documentElement.style.setProperty('--page-bg', '#0f0b12');
                document.documentElement.style.setProperty('--bg-1', 'rgba(255,160,90,0.12)');
                document.documentElement.style.setProperty('--bg-2', 'rgba(130,70,180,0.18)');
                document.body.style.backgroundImage =
                    'radial-gradient(circle at 10% 10%, rgba(255,140,80,0.28), transparent 200px),' +
                    'radial-gradient(circle at 90% 30%, rgba(130,70,180,0.20), transparent 300px),' +
                    'linear-gradient(180deg, rgba(6,6,10,0.6), rgba(10,6,20,0.8))';
            },

            "obsidian": () => {
                document.documentElement.style.setProperty('--page-bg', '#0b0b0b');
                document.documentElement.style.setProperty('--bg-1', 'rgba(40,40,40,0.08)');
                document.documentElement.style.setProperty('--bg-2', 'rgba(80,80,80,0.06)');
                document.body.style.backgroundImage =
                    'radial-gradient(circle at 50% 0%, rgba(255,255,255,0.02), transparent 220px),' +
                    'linear-gradient(180deg,#090909,#111111)';
            },

            "saphire": () => {
                document.documentElement.style.setProperty('--page-bg', '#071027');
                document.documentElement.style.setProperty('--bg-1', 'rgba(0,180,255,0.06)');
                document.documentElement.style.setProperty('--bg-2', 'rgba(10,40,180,0.12)');
                document.body.style.backgroundImage =
                    'radial-gradient(circle at 80% 10%, rgba(0,160,255,0.18), transparent 240px),' +
                    'radial-gradient(circle at 20% 90%, rgba(10,40,200,0.12), transparent 260px),' +
                    'linear-gradient(180deg,#030617,#06132b)';
            },

            "parrot": () => {
                document.documentElement.style.setProperty('--page-bg', '#071a16');
                document.documentElement.style.setProperty('--bg-1', 'rgba(50,230,170,0.06)');
                document.documentElement.style.setProperty('--bg-2', 'rgba(0,180,140,0.08)');
                document.body.style.backgroundImage =
                    'radial-gradient(circle at 80% 20%, rgba(120,240,200,0.14), transparent 240px),' +
                    'radial-gradient(circle at 10% 90%, rgba(20,200,150,0.08), transparent 260px),' +
                    'linear-gradient(180deg,#03120f,#071a16)';
            },

            "icicle": () => {
                document.documentElement.style.setProperty('--page-bg', '#071221');
                document.documentElement.style.setProperty('--bg-1', 'rgba(160,240,255,0.06)');
                document.documentElement.style.setProperty('--bg-2', 'rgba(120,200,255,0.08)');
                document.body.style.backgroundImage =
                    'radial-gradient(circle at 60% 20%, rgba(160,240,255,0.12), transparent 240px),' +
                    'linear-gradient(180deg,#051019,#062233)';
            },

            "lime": () => {
                document.documentElement.style.setProperty('--page-bg', '#0b1410');
                document.documentElement.style.setProperty('--bg-1', 'rgba(180,255,120,0.08)');
                document.documentElement.style.setProperty('--bg-2', 'rgba(120,220,80,0.06)');
                document.body.style.backgroundImage =
                    'radial-gradient(circle at 80% 10%, rgba(180,255,120,0.12), transparent 240px),' +
                    'linear-gradient(180deg,#05100a,#092013)';
            },

            "light": () => {
                document.documentElement.style.setProperty('--page-bg', '#f6f7fb');
                document.documentElement.style.setProperty('--bg-1', 'rgba(65,98,255,0.03)');
                document.documentElement.style.setProperty('--bg-2', 'rgba(65,98,255,0.02)');
                document.body.style.backgroundImage =
                    'linear-gradient(180deg,#ffffff,#f1f4fb)';
                document.body.style.color = '#111';
            },

            "default": () => {
                document.documentElement.style.setProperty('--page-bg', '#141414');
                document.documentElement.style.setProperty('--bg-1', 'rgba(65,98,255,0.06)');
                document.documentElement.style.setProperty('--bg-2', 'rgba(65,98,255,0.18)');
                document.body.style.backgroundImage =
                    'radial-gradient(circle at 94% 6%, rgba(65,98,255,0.48), rgba(65,98,255,0.06) 340px, transparent 500px),' +
                    'radial-gradient(circle at 0% 88%, rgba(65,98,255,0.48), rgba(65,98,255,0.06) 340px, transparent 500px),' +
                    'radial-gradient(circle at 75% 105%, rgba(65,98,255,0.45), rgba(65,98,255,0.05) 300px, transparent 500px),' +
                    'radial-gradient(circle at 20% 20%, rgba(65,98,255,0.22), transparent 320px),' +
                    'radial-gradient(circle at 80% 70%, rgba(65,98,255,0.18), transparent 300px),' +
                    'radial-gradient(circle at 50% 10%, rgba(65,98,255,0.15), transparent 260px),' +
                    'radial-gradient(circle at 12% 60%, rgba(65,98,255,0.22), transparent 300px)';
                document.body.style.color = '';
            },

            "dark": () => {
                document.documentElement.style.setProperty('--page-bg', '#0f0f10');
                document.documentElement.style.setProperty('--bg-1', 'rgba(0,0,0,0.06)');
                document.documentElement.style.setProperty('--bg-2', 'rgba(0,0,0,0.04)');
                document.body.style.backgroundImage =
                    'linear-gradient(180deg,#0b0b0b,#141414)';
            }
        };

        function applyTheme(name) {
            const fn = themes[name] || themes['default'];
            document.body.style.color = '';
            fn();
            localStorage.setItem(THEME_KEY, name);
            document.querySelectorAll('.swatch').forEach(s => {
                s.classList.toggle('selected', s.dataset.theme === name);
            });
        }

        function initTheme() {
            const saved = localStorage.getItem(THEME_KEY) || 'default';
            applyTheme(saved);
        }

        document.addEventListener('click', (e) => {
            const sw = e.target.closest('.swatch');
            if (!sw) return;
            const theme = sw.dataset.theme;
            if (!theme) return;
            applyTheme(theme);
        });

        document.querySelectorAll('.menu-item').forEach(mi => {
            mi.addEventListener('click', () => {
                document.querySelectorAll('.menu-item').forEach(x => x.classList.remove('active'));
                mi.classList.add('active');
                const tab = mi.dataset.tab;
            });
        });

        initProfile().finally(initTheme);


        function renderBillingHistoryPage(entries = [], page = 1, perPage = 8) {
            const billingList = document.getElementById("billingList");
            const pageNumberEl = document.querySelector('.page-number');
            const prevBtn = document.getElementById('prevPage');
            const nextBtn = document.getElementById('nextPage');

            billingList.innerHTML = "";

            if (!entries || entries.length === 0) {
                const emptyMsg = document.createElement("div");
                emptyMsg.className = "billing-empty";
                emptyMsg.textContent = "No Billing History";
                billingList.appendChild(emptyMsg);
                pageNumberEl.textContent = 'Page 0';
                prevBtn.disabled = true; nextBtn.disabled = true;
                return;
            }

            const totalPages = Math.max(1, Math.ceil(entries.length / perPage));
            const current = Math.min(Math.max(1, page), totalPages);
            const start = (current - 1) * perPage;
            const slice = entries.slice(start, start + perPage);

            slice.forEach(entry => {
                const row = document.createElement("div");
                row.className = "billing-entry";
                row.innerHTML = `<span>${entry.date}</span><span>${entry.amount}</span>`;
                billingList.appendChild(row);
            });

            pageNumberEl.textContent = `Page ${current} / ${totalPages}`;
            prevBtn.disabled = current <= 1;
            nextBtn.disabled = current >= totalPages;

            prevBtn.onclick = () => renderBillingHistoryPage(entries, Math.max(1, current - 1), perPage);
            nextBtn.onclick = () => renderBillingHistoryPage(entries, Math.min(totalPages, current + 1), perPage);
        }

        const billingData = [];

        const pageDescEl = document.querySelector('.page-desc');
        const pageTitleEl = document.querySelector('.page-title');

        renderBillingHistoryPage(billingData, 1);

        const giftsData = [];

        function renderGifts() {
            const grid = document.getElementById('giftsGrid');
            if (!grid) return;
            grid.innerHTML = '';
            if (!giftsData || giftsData.length === 0) {
                const empty = document.createElement('div');
                empty.className = 'billing-empty';
                empty.textContent = 'No pending gifts';
                grid.appendChild(empty);
                return;
            }

            giftsData.forEach(g => {
                const item = document.createElement('div');
                item.className = 'gift-item';
                item.dataset.giftId = g.id;
                const icon = document.createElement('div');
                icon.className = 'gift-icon';
                icon.textContent = 'ðŸŽ';
                item.appendChild(icon);
                const label = document.createElement('div');
                label.className = 'gift-title';
                label.textContent = g.title;
                item.appendChild(label);

                item.addEventListener('click', () => openGiftModal(g.id));
                grid.appendChild(item);
            });
        }

        function openGiftModal(giftId) {
            const g = giftsData.find(x => x.id === giftId);
            if (!g) return;
            document.getElementById('giftModalTitle').textContent = g.title;
            document.getElementById('giftModalDesc').textContent = g.desc;
            const preview = document.getElementById('giftModalPreview');
            preview.innerHTML = '';
            const p = document.createElement('div');
            p.textContent = g.preview;
            preview.appendChild(p);

            const overlay = document.getElementById('giftModal');
            overlay.style.display = 'flex';

            const claimBtn = document.getElementById('claimGiftBtn');
            claimBtn.onclick = () => {
                const idx = giftsData.findIndex(x => x.id === giftId);
                if (idx !== -1) giftsData.splice(idx, 1);
                renderGifts();

                    function addDeveloperTrialButton() {
                        if (document.getElementById('devTrialBtn')) return;
                        const btn = document.createElement('button');
                        btn.id = 'devTrialBtn';
                        btn.textContent = 'Send Free Trial Gift';
                        btn.style = 'margin: 18px 0; background: #4162ff; color: #fff; font-weight: 700; border: none; border-radius: 10px; padding: 12px 24px; cursor: pointer; font-size: 18px;';

                        const select = document.createElement('select');
                        select.id = 'devTrialDuration';
                        select.style = 'margin-left: 12px; font-size: 16px; padding: 6px; border-radius: 6px;';
                        [
                            {label: '1 Day', value: '1 day'},
                            {label: '3 Days', value: '3 days'},
                            {label: '7 Days', value: '7 days'},
                            {label: '1 Month', value: '1 month'}
                        ].forEach(opt => {
                            const o = document.createElement('option');
                            o.value = opt.value;
                            o.textContent = opt.label;
                            select.appendChild(o);
                        });
                        btn.appendChild(select);

                        btn.addEventListener('click', function(e) {
                            e.preventDefault();
                            const duration = select.value;
                            sendTrialGift(duration);
                        });

                        const giftsPanel = document.getElementById('giftsPanel');
                        giftsPanel.parentNode.insertBefore(btn, giftsPanel);
                    }

                    function generateKey() {
                        const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
                        let key = '';
                        for (let i = 0; i < 16; i++) {
                            key += chars[Math.floor(Math.random() * chars.length)];
                        }
                        return key;
                    }

                    function sendTrialGift(duration) {
                        const key = generateKey();
                        const now = new Date();
                        let expiresAt = null;
                        if (duration === '1 day') {
                            expiresAt = new Date(now.getTime() + 1 * 24 * 60 * 60 * 1000);
                        } else if (duration === '3 days') {
                            expiresAt = new Date(now.getTime() + 3 * 24 * 60 * 60 * 1000);
                        } else if (duration === '7 days') {
                            expiresAt = new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000);
                        } else if (duration === '1 month') {
                            expiresAt = new Date(now.getTime() + 30 * 24 * 60 * 60 * 1000);
                        }
                        const expiryText = expiresAt ? expiresAt.toLocaleString() : 'Never';

                        giftsData.push({
                            id: 'trial-' + Date.now() + '-' + Math.floor(Math.random() * 10000),
                            title: `Free Premium Trial (${duration})`,
                            desc: `Claim your free premium trial for ${duration}. Expires: ${expiryText}`,
                            preview: `Key: ${key}\nExpires: ${expiryText}`,
                            key: key,
                            expiresAt: expiresAt,
                            oneTime: true
                        });
                        renderGifts();
                        alert('Trial gift sent to all users!');
                    }
                overlay.style.display = 'none';
                alert('Gift claimed: ' + g.title);
            };
        }

        function closeGiftModal() {
            const overlay = document.getElementById('giftModal');
            if (overlay) overlay.style.display = 'none';
        }

        document.getElementById('closeGiftBtn')?.addEventListener('click', closeGiftModal);
        document.getElementById('closeGiftX')?.addEventListener('click', closeGiftModal);

        renderGifts();

        const tabPanels = {
            appearance: document.getElementById("appearancePanel"),
            billing: document.getElementById("billingPanel"),
            gifts: document.getElementById("giftsPanel"),
        };

        (function setInitialPanel() {
            const initial = 'appearance';
            document.querySelector('.page-title').textContent = 'Change your page appearance!';
            if (pageDescEl) pageDescEl.style.display = 'block';
            if (pageDescEl) pageDescEl.textContent = 'Choose from our preset color schemes to make our website look the way you want!';
            Object.entries(tabPanels).forEach(([key, panel]) => {
                if (!panel) return;
                panel.style.display = key === initial ? "block" : "none";
            });
        })();

        document.querySelectorAll('.menu-item').forEach(mi => {
            mi.addEventListener('click', () => {
                document.querySelectorAll('.menu-item').forEach(x => x.classList.remove('active'));
                mi.classList.add('active');

                const tab = mi.dataset.tab;
                Object.entries(tabPanels).forEach(([key, panel]) => {
                    panel.style.display = key === tab ? "block" : "none";
                });

                const titleEl = document.querySelector('.page-title');
                if (tab === 'appearance') {
                    titleEl.textContent = 'Change your page appearance!';
                    if (pageDescEl) { pageDescEl.style.display = 'block'; pageDescEl.textContent = 'Choose from our preset color schemes to make our website look the way you want!'; }
                } else if (tab === 'billing') {
                    titleEl.textContent = 'Your Billing History';
                    if (pageDescEl) pageDescEl.style.display = 'none';
                } else if (tab === 'gifts') {
                    titleEl.textContent = 'Pending Gifts!';
                    if (pageDescEl) pageDescEl.style.display = 'none';
                    renderGifts();
                }

                if (tab === 'billing') renderBillingHistoryPage(billingData, 1);
            });
        });
    </script>
</body>

</html>